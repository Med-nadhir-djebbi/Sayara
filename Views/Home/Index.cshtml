@{
    ViewData["Title"] = "Home";
}

<div class="hero">
    <div class="container">
        <h1>Find Your Perfect Drive</h1>
        <p>Whether you want to buy your dream car or rent one for the weekend, Sayara has you covered.</p>
        <div style="margin-top: 32px; display: flex; justify-content: center; gap: 16px;">
            <a href="/vehicles" class="btn btn-white" style="background: white; color: var(--primary-blue); padding: 12px 32px; font-size: 1rem; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">Browse Vehicles</a>
            <a href="/create?type=sale" class="btn btn-success" style="padding: 12px 32px; font-size: 1rem;">List Your Car</a>
        </div>
    </div>
</div>

<div class="container" style="padding: 60px 20px;">
    <h2 style="text-align: center; margin-bottom: 40px; color: var(--primary-blue);">Featured Vehicles</h2>
    
    <div class="listings-grid" id="featuredListings">
        <!-- Listings will be loaded here via JS -->
    </div>
    
    <div style="text-align: center; margin-top: 40px;">
        <a href="/vehicles" class="btn btn-outline" style="min-width: 200px;">View All Vehicles</a>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", async () => {
        const container = document.getElementById('featuredListings');
        
        try {
            // Fetch sale listings for the home page (limit via slice in JS for now or backend endpoint)
            const response = await fetch('/api/Listings/sale');
            const result = await response.json();
            
            if (response.ok && result.data) {
                // Assuming result.data is an array of listings
                const listings = result.data.slice(0, 3); // Show top 3
                
                if (listings.length === 0) {
                    container.innerHTML = '<p style="text-align:center; width:100%;">No listings available right now.</p>';
                    return;
                }

                listings.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'listing-card';
                    card.innerHTML = `
                        <div class="card-img">
                            <!-- Placeholder image logic -->
                            <img src="https://placehold.co/400x300?text=${encodeURIComponent(item.model || 'Car')}" alt="${item.model}" style="width:100%; height:100%; object-fit:cover;">
                        </div>
                        <div class="card-body">
                            <div class="card-title">${item.brand} ${item.model}</div>
                            <div class="card-price">$${(item.price || 0).toLocaleString()}</div>
                            <div style="color: var(--text-muted); font-size: 0.9rem; margin-top: 8px;">
                                ${item.year} • ${item.mileage} km
                            </div>
                            <!-- Assuming we have a Details page route configured -->
                            <button onclick="window.location.href='/details/${item.id}?type=sale'" class="btn btn-primary" style="width: 100%; margin-top: 16px;">View Details</button>
                        </div>
                    `;
                    container.appendChild(card);
                });
            } else {
                 container.innerHTML = '<p>No listings found.</p>';
            }
        } catch (err) {
            console.error(err);
            container.innerHTML = '<p>Failed to load listings.</p>';
        }
    });
</script>
